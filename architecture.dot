/* TODO: Figure out how to make the arrows go to the clusters, rather than
 * their contents. */

digraph G {
    labelloc=t;
    node [shape=box];

    subgraph cluster_sources {
        style=invisible;
        hdd [label="HDD"];
        internet [label="Internet"];
        db [label="Database"];
    }

    subgraph cluster_spidering {
        style=invisible;
        /* TODO: Each of these should be its own rank. */
        cache [label="Caching"];
        retrieval [label="Retrieval"];
        parsing [label="Metadata Extraction\nand Sanitization"];
    }

    subgraph cluster_serialization {
        label = "Serialization";
        ser_json [label="JSON",style=dashed];
        ser_html [label="HTML"];
        ser_epub [label="ePub",style=dashed];
    }

    subgraph cluster_conversion {
        label = "Conversion";
        conv_mobi  [label="Mobi"];
        conv_lrf  [label="LRF/BeBB"];
        conv_epub [label="ePub"];
    }

    output [label="Output",style=rounded];

    internet -> retrieval;
    db -> cache [dir=both];
    hdd -> retrieval [dir=both];
    cache -> retrieval;
    retrieval -> parsing [dir=both,label="Spidering"];
    parsing -> hdd [style=dashed];
    parsing -> db [style=dashed];
    parsing -> ser_html;
    ser_html -> conv_lrf;
    conv_lrf -> output;

    label="fanfic2ebook: Information Flow\nTODO: Migrate to something which will let me set ranks explicitly.";
}
